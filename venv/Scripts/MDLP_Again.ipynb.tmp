{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "initial_id",
   "metadata": {
    "collapsed": true,
    "ExecuteTime": {
     "end_time": "2024-10-25T14:37:30.646854300Z",
     "start_time": "2024-10-25T14:37:30.131394700Z"
    }
   },
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import os\n",
    "\n",
    "file_path = '/mnt/d/Doc_To_Date/20241221/Out_8_final_29806_full.xlsx'\n",
    "\n",
    "def read_file(file_path):\n",
    "    df = pd.read_excel(file_path)\n",
    "    return df\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "outputs": [],
   "source": [
    "df = read_file(file_path)"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-10-25T14:37:45.635500Z",
     "start_time": "2024-10-25T14:37:30.653516Z"
    }
   },
   "id": "60bc16c50251ed92"
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "outputs": [
    {
     "data": {
      "text/plain": "       Unnamed: 0           GTIN                      Код ЕСКЛП (drug code)  \\\n0               0  4601907002829  21.20.10.211-000019-1-00226-2000001150849   \n1               4  4606556002770  21.20.10.194-000022-1-00157-2000000520063   \n2               9  4607159862518  21.20.10.236-000024-1-00114-2000000590663   \n3              11  4620017180104  21.20.10.149-000001-1-00092-2000001182384   \n4              19  4602565019327  21.20.10.224-000017-1-00084-2000000609435   \n...           ...            ...                                        ...   \n29801       58062  4660153658686  21.20.10.145-000005-1-00025-2000001405824   \n29802       58063  4660153658693  21.20.10.145-000005-1-00025-2000001405089   \n29803       58064  4604060000121  21.20.10.256-000004-1-00014-2000001387339   \n29804       58065  4605310029640  21.20.10.231-000016-1-00040-2000001406755   \n29805       58066  4630179317591  21.20.10.261-000108-1-00022-2000001402063   \n\n                  Версия Drug Code              Номер РУ Дата регистрации РУ  \\\n0      2 - актуальные данные ЕСКЛП          П N012038/01          09.07.2010   \n1      2 - актуальные данные ЕСКЛП         ЛСР-000539/08          11.02.2008   \n2      2 - актуальные данные ЕСКЛП         ЛСР-000540/08          11.02.2008   \n3      2 - актуальные данные ЕСКЛП          П N014014/01          02.06.2009   \n4      2 - актуальные данные ЕСКЛП             ЛП-000465          01.03.2011   \n...                            ...                   ...                 ...   \n29801  2 - актуальные данные ЕСКЛП  ЛП-№(007025)-(РГ-RU)          27.09.2024   \n29802  2 - актуальные данные ЕСКЛП  ЛП-№(007025)-(РГ-RU)          27.09.2024   \n29803  2 - актуальные данные ЕСКЛП  ЛП-№(006067)-(РГ-RU)          28.06.2024   \n29804  2 - актуальные данные ЕСКЛП  ЛП-№(006806)-(РГ-RU)          09.09.2024   \n29805  2 - актуальные данные ЕСКЛП  ЛП-№(006876)-(РГ-RU)          13.09.2024   \n\n      Торговое наименование МНН (стандартизованное значение)  \\\n0                 Герцептин                      ТРАСТУЗУМАБ   \n1                   Калетра              ЛОПИНАВИР+РИТОНАВИР   \n2                Вальдоксан                       АГОМЕЛАТИН   \n3                  Липримар                     АТОРВАСТАТИН   \n4                Кетопрофен                       КЕТОПРОФЕН   \n...                     ...                              ...   \n29801           Троксерутин                      ТРОКСЕРУТИН   \n29802           Троксерутин                      ТРОКСЕРУТИН   \n29803          Дезлоратадин                     ДЕЗЛОРАТАДИН   \n29804            Лонградакс                        ДЕСФЛУРАН   \n29805    Бримонтим солофарм               БРИМОНИДИН+ТИМОЛОЛ   \n\n      МНН (нормализованное значение)  \\\n0                        ТРАСТУЗУМАБ   \n1                ЛОПИНАВИР+РИТОНАВИР   \n2                         АГОМЕЛАТИН   \n3                       АТОРВАСТАТИН   \n4                         КЕТОПРОФЕН   \n...                              ...   \n29801                    ТРОКСЕРУТИН   \n29802                    ТРОКСЕРУТИН   \n29803                   ДЕЗЛОРАТАДИН   \n29804                      ДЕСФЛУРАН   \n29805             БРИМОНИДИН+ТИМОЛОЛ   \n\n                         Наименование товара на этикетке  ...    №  \\\n0      Герцептин, лиофилизат для приготовления концен...  ...  NaN   \n1      Калетра®, таблетки покрытые пленочной оболочко...  ...  2.0   \n2      Вальдоксан®, таблетки, покрытые пленочной обол...  ...  4.0   \n3      липримар, таблетки покрытые пленочной оболочко...  ...  4.0   \n4            Кетопрофен гель для наружного применения 5%  ...  NaN   \n...                                                  ...  ...  ...   \n29801  Троксерутин, гель для наружного применения 2% ...  ...  NaN   \n29802  Троксерутин, гель для наружного применения 2% ...  ...  NaN   \n29803  Дезлоратадин, таблетки, покрытые пленочной обо...  ...  NaN   \n29804     Лонградакс® (Десфлуран) жидкость для ингаляций  ...  6.0   \n29805  Бримонтим солофарм, 2 мг/мл + 5 мг/мл, капли г...  ...  NaN   \n\n                                         Очищеный тайитл  \\\n0      Герцептин, лиофилизат для приготовления концен...   \n1      Калетра®, таблетки покрытые пленочной оболочко...   \n2      Вальдоксан®, таблетки, покрытые пленочной обол...   \n3      липримар, таблетки покрытые пленочной оболочко...   \n4      Кетопрофен гель для наружного применения 5% 30...   \n...                                                  ...   \n29801  Троксерутин, гель для наружного применения 2% ...   \n29802  Троксерутин, гель для наружного применения 2% ...   \n29803  Дезлоратадин, таблетки, покрытые пленочной обо...   \n29804  Лонградакс® (Десфлуран) жидкость для ингаляций...   \n29805  Бримонтим солофарм, 2 мг/мл + 5 мг/мл, капли г...   \n\n           Производитель готовой ЛФ Название проивзодителя для МС  \\\n0                    ДЖЕНЕНТЕК ИНК.                     Дженентек   \n1      ЭББВИ ДОЙЧЛАНД ГМБХ И КО. КГ                         ЭББВИ   \n2                    ООО СЕРВЬЕ РУС                       Сервье*   \n3         ПФАЙЗЕР ФАРМАСЬЮТИКАЛ ЛЛС                  есть кабинет   \n4                        ОАО СИНТЕЗ                       Синтез*   \n...                             ...                           ...   \n29801                      OOO ОЗОН                      ОЗОН-МНН   \n29802                      OOO ОЗОН                      ОЗОН-МНН   \n29803        АО ТАТХИМФАРМПРЕПАРАТЫ         Татхимфармпрепараты $   \n29804                АО ФАРМАСИНТЕЗ                   Фармасинтез   \n29805                   ООО ГРОТЕКС                     Гротекс *   \n\n                                         id  \\\n0      834bd517-4fdf-4d3f-a50e-97450a057805   \n1      c8197846-a43d-4fab-a5e2-ab04cba782e4   \n2      caf4c351-0634-4f52-a092-1cc19bc3ed11   \n3                                       NaN   \n4      60a5c875-a54d-4cad-ac07-2ce8227b58b8   \n...                                     ...   \n29801  3b11b571-7218-43c4-90b9-bbcf3abf2472   \n29802  3b11b571-7218-43c4-90b9-bbcf3abf2472   \n29803  4210af3e-af48-4d85-ba65-4ed1d5927c4e   \n29804  867880f1-9566-4754-acc2-15e13cade035   \n29805  c8d54c89-3a3b-4c78-8c12-b995cb05da10   \n\n      Страна регистрации производителя готовой ЛФ Код ТН ВЭД  \\\n0                               СОЕДИНЕННЫЕ ШТАТЫ          -   \n1                                        ГЕРМАНИЯ          -   \n2                                          РОССИЯ          -   \n3                                     ПУЭРТО-РИКО          -   \n4                                          РОССИЯ          -   \n...                                           ...        ...   \n29801                                      РОССИЯ        NaN   \n29802                                      РОССИЯ        NaN   \n29803                                      РОССИЯ        NaN   \n29804                                      РОССИЯ        NaN   \n29805                                      РОССИЯ        NaN   \n\n      Контакт производителя Комплектность  Признак \"ПКУ\"  \n0                         -  РАСТВОРИТЕЛЬ            Нет  \n1                         -             ~            Нет  \n2                         -             ~            Нет  \n3                         -             ~            Нет  \n4                         -             ~            Нет  \n...                     ...           ...            ...  \n29801                   NaN             ~            Нет  \n29802                   NaN             ~            Нет  \n29803                   NaN             ~            Нет  \n29804                   NaN             ~            Нет  \n29805                   NaN             ~            Нет  \n\n[29806 rows x 35 columns]",
      "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Unnamed: 0</th>\n      <th>GTIN</th>\n      <th>Код ЕСКЛП (drug code)</th>\n      <th>Версия Drug Code</th>\n      <th>Номер РУ</th>\n      <th>Дата регистрации РУ</th>\n      <th>Торговое наименование</th>\n      <th>МНН (стандартизованное значение)</th>\n      <th>МНН (нормализованное значение)</th>\n      <th>Наименование товара на этикетке</th>\n      <th>...</th>\n      <th>№</th>\n      <th>Очищеный тайитл</th>\n      <th>Производитель готовой ЛФ</th>\n      <th>Название проивзодителя для МС</th>\n      <th>id</th>\n      <th>Страна регистрации производителя готовой ЛФ</th>\n      <th>Код ТН ВЭД</th>\n      <th>Контакт производителя</th>\n      <th>Комплектность</th>\n      <th>Признак \"ПКУ\"</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0</td>\n      <td>4601907002829</td>\n      <td>21.20.10.211-000019-1-00226-2000001150849</td>\n      <td>2 - актуальные данные ЕСКЛП</td>\n      <td>П N012038/01</td>\n      <td>09.07.2010</td>\n      <td>Герцептин</td>\n      <td>ТРАСТУЗУМАБ</td>\n      <td>ТРАСТУЗУМАБ</td>\n      <td>Герцептин, лиофилизат для приготовления концен...</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>Герцептин, лиофилизат для приготовления концен...</td>\n      <td>ДЖЕНЕНТЕК ИНК.</td>\n      <td>Дженентек</td>\n      <td>834bd517-4fdf-4d3f-a50e-97450a057805</td>\n      <td>СОЕДИНЕННЫЕ ШТАТЫ</td>\n      <td>-</td>\n      <td>-</td>\n      <td>РАСТВОРИТЕЛЬ</td>\n      <td>Нет</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>4</td>\n      <td>4606556002770</td>\n      <td>21.20.10.194-000022-1-00157-2000000520063</td>\n      <td>2 - актуальные данные ЕСКЛП</td>\n      <td>ЛСР-000539/08</td>\n      <td>11.02.2008</td>\n      <td>Калетра</td>\n      <td>ЛОПИНАВИР+РИТОНАВИР</td>\n      <td>ЛОПИНАВИР+РИТОНАВИР</td>\n      <td>Калетра®, таблетки покрытые пленочной оболочко...</td>\n      <td>...</td>\n      <td>2.0</td>\n      <td>Калетра®, таблетки покрытые пленочной оболочко...</td>\n      <td>ЭББВИ ДОЙЧЛАНД ГМБХ И КО. КГ</td>\n      <td>ЭББВИ</td>\n      <td>c8197846-a43d-4fab-a5e2-ab04cba782e4</td>\n      <td>ГЕРМАНИЯ</td>\n      <td>-</td>\n      <td>-</td>\n      <td>~</td>\n      <td>Нет</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>9</td>\n      <td>4607159862518</td>\n      <td>21.20.10.236-000024-1-00114-2000000590663</td>\n      <td>2 - актуальные данные ЕСКЛП</td>\n      <td>ЛСР-000540/08</td>\n      <td>11.02.2008</td>\n      <td>Вальдоксан</td>\n      <td>АГОМЕЛАТИН</td>\n      <td>АГОМЕЛАТИН</td>\n      <td>Вальдоксан®, таблетки, покрытые пленочной обол...</td>\n      <td>...</td>\n      <td>4.0</td>\n      <td>Вальдоксан®, таблетки, покрытые пленочной обол...</td>\n      <td>ООО СЕРВЬЕ РУС</td>\n      <td>Сервье*</td>\n      <td>caf4c351-0634-4f52-a092-1cc19bc3ed11</td>\n      <td>РОССИЯ</td>\n      <td>-</td>\n      <td>-</td>\n      <td>~</td>\n      <td>Нет</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>11</td>\n      <td>4620017180104</td>\n      <td>21.20.10.149-000001-1-00092-2000001182384</td>\n      <td>2 - актуальные данные ЕСКЛП</td>\n      <td>П N014014/01</td>\n      <td>02.06.2009</td>\n      <td>Липримар</td>\n      <td>АТОРВАСТАТИН</td>\n      <td>АТОРВАСТАТИН</td>\n      <td>липримар, таблетки покрытые пленочной оболочко...</td>\n      <td>...</td>\n      <td>4.0</td>\n      <td>липримар, таблетки покрытые пленочной оболочко...</td>\n      <td>ПФАЙЗЕР ФАРМАСЬЮТИКАЛ ЛЛС</td>\n      <td>есть кабинет</td>\n      <td>NaN</td>\n      <td>ПУЭРТО-РИКО</td>\n      <td>-</td>\n      <td>-</td>\n      <td>~</td>\n      <td>Нет</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>19</td>\n      <td>4602565019327</td>\n      <td>21.20.10.224-000017-1-00084-2000000609435</td>\n      <td>2 - актуальные данные ЕСКЛП</td>\n      <td>ЛП-000465</td>\n      <td>01.03.2011</td>\n      <td>Кетопрофен</td>\n      <td>КЕТОПРОФЕН</td>\n      <td>КЕТОПРОФЕН</td>\n      <td>Кетопрофен гель для наружного применения 5%</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>Кетопрофен гель для наружного применения 5% 30...</td>\n      <td>ОАО СИНТЕЗ</td>\n      <td>Синтез*</td>\n      <td>60a5c875-a54d-4cad-ac07-2ce8227b58b8</td>\n      <td>РОССИЯ</td>\n      <td>-</td>\n      <td>-</td>\n      <td>~</td>\n      <td>Нет</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>29801</th>\n      <td>58062</td>\n      <td>4660153658686</td>\n      <td>21.20.10.145-000005-1-00025-2000001405824</td>\n      <td>2 - актуальные данные ЕСКЛП</td>\n      <td>ЛП-№(007025)-(РГ-RU)</td>\n      <td>27.09.2024</td>\n      <td>Троксерутин</td>\n      <td>ТРОКСЕРУТИН</td>\n      <td>ТРОКСЕРУТИН</td>\n      <td>Троксерутин, гель для наружного применения 2% ...</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>Троксерутин, гель для наружного применения 2% ...</td>\n      <td>OOO ОЗОН</td>\n      <td>ОЗОН-МНН</td>\n      <td>3b11b571-7218-43c4-90b9-bbcf3abf2472</td>\n      <td>РОССИЯ</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>~</td>\n      <td>Нет</td>\n    </tr>\n    <tr>\n      <th>29802</th>\n      <td>58063</td>\n      <td>4660153658693</td>\n      <td>21.20.10.145-000005-1-00025-2000001405089</td>\n      <td>2 - актуальные данные ЕСКЛП</td>\n      <td>ЛП-№(007025)-(РГ-RU)</td>\n      <td>27.09.2024</td>\n      <td>Троксерутин</td>\n      <td>ТРОКСЕРУТИН</td>\n      <td>ТРОКСЕРУТИН</td>\n      <td>Троксерутин, гель для наружного применения 2% ...</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>Троксерутин, гель для наружного применения 2% ...</td>\n      <td>OOO ОЗОН</td>\n      <td>ОЗОН-МНН</td>\n      <td>3b11b571-7218-43c4-90b9-bbcf3abf2472</td>\n      <td>РОССИЯ</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>~</td>\n      <td>Нет</td>\n    </tr>\n    <tr>\n      <th>29803</th>\n      <td>58064</td>\n      <td>4604060000121</td>\n      <td>21.20.10.256-000004-1-00014-2000001387339</td>\n      <td>2 - актуальные данные ЕСКЛП</td>\n      <td>ЛП-№(006067)-(РГ-RU)</td>\n      <td>28.06.2024</td>\n      <td>Дезлоратадин</td>\n      <td>ДЕЗЛОРАТАДИН</td>\n      <td>ДЕЗЛОРАТАДИН</td>\n      <td>Дезлоратадин, таблетки, покрытые пленочной обо...</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>Дезлоратадин, таблетки, покрытые пленочной обо...</td>\n      <td>АО ТАТХИМФАРМПРЕПАРАТЫ</td>\n      <td>Татхимфармпрепараты $</td>\n      <td>4210af3e-af48-4d85-ba65-4ed1d5927c4e</td>\n      <td>РОССИЯ</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>~</td>\n      <td>Нет</td>\n    </tr>\n    <tr>\n      <th>29804</th>\n      <td>58065</td>\n      <td>4605310029640</td>\n      <td>21.20.10.231-000016-1-00040-2000001406755</td>\n      <td>2 - актуальные данные ЕСКЛП</td>\n      <td>ЛП-№(006806)-(РГ-RU)</td>\n      <td>09.09.2024</td>\n      <td>Лонградакс</td>\n      <td>ДЕСФЛУРАН</td>\n      <td>ДЕСФЛУРАН</td>\n      <td>Лонградакс® (Десфлуран) жидкость для ингаляций</td>\n      <td>...</td>\n      <td>6.0</td>\n      <td>Лонградакс® (Десфлуран) жидкость для ингаляций...</td>\n      <td>АО ФАРМАСИНТЕЗ</td>\n      <td>Фармасинтез</td>\n      <td>867880f1-9566-4754-acc2-15e13cade035</td>\n      <td>РОССИЯ</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>~</td>\n      <td>Нет</td>\n    </tr>\n    <tr>\n      <th>29805</th>\n      <td>58066</td>\n      <td>4630179317591</td>\n      <td>21.20.10.261-000108-1-00022-2000001402063</td>\n      <td>2 - актуальные данные ЕСКЛП</td>\n      <td>ЛП-№(006876)-(РГ-RU)</td>\n      <td>13.09.2024</td>\n      <td>Бримонтим солофарм</td>\n      <td>БРИМОНИДИН+ТИМОЛОЛ</td>\n      <td>БРИМОНИДИН+ТИМОЛОЛ</td>\n      <td>Бримонтим солофарм, 2 мг/мл + 5 мг/мл, капли г...</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>Бримонтим солофарм, 2 мг/мл + 5 мг/мл, капли г...</td>\n      <td>ООО ГРОТЕКС</td>\n      <td>Гротекс *</td>\n      <td>c8d54c89-3a3b-4c78-8c12-b995cb05da10</td>\n      <td>РОССИЯ</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>~</td>\n      <td>Нет</td>\n    </tr>\n  </tbody>\n</table>\n<p>29806 rows × 35 columns</p>\n</div>"
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-10-25T14:37:45.716916Z",
     "start_time": "2024-10-25T14:37:45.646732500Z"
    }
   },
   "id": "e5c9d159ebb96cfa"
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "   Unnamed: 0           GTIN                      Код ЕСКЛП (drug code)  \\\n",
      "0           0  4601907002829  21.20.10.211-000019-1-00226-2000001150849   \n",
      "1           4  4606556002770  21.20.10.194-000022-1-00157-2000000520063   \n",
      "2           9  4607159862518  21.20.10.236-000024-1-00114-2000000590663   \n",
      "3          11  4620017180104  21.20.10.149-000001-1-00092-2000001182384   \n",
      "4          19  4602565019327  21.20.10.224-000017-1-00084-2000000609435   \n",
      "\n",
      "              Версия Drug Code       Номер РУ Дата регистрации РУ  \\\n",
      "0  2 - АКТУАЛЬНЫЕ ДАННЫЕ ЕСКЛП   П N012038/01          09.07.2010   \n",
      "1  2 - АКТУАЛЬНЫЕ ДАННЫЕ ЕСКЛП  ЛСР-000539/08          11.02.2008   \n",
      "2  2 - АКТУАЛЬНЫЕ ДАННЫЕ ЕСКЛП  ЛСР-000540/08          11.02.2008   \n",
      "3  2 - АКТУАЛЬНЫЕ ДАННЫЕ ЕСКЛП   П N014014/01          02.06.2009   \n",
      "4  2 - АКТУАЛЬНЫЕ ДАННЫЕ ЕСКЛП      ЛП-000465          01.03.2011   \n",
      "\n",
      "  Торговое наименование МНН (стандартизованное значение)  \\\n",
      "0             ГЕРЦЕПТИН                      ТРАСТУЗУМАБ   \n",
      "1               КАЛЕТРА              ЛОПИНАВИР+РИТОНАВИР   \n",
      "2            ВАЛЬДОКСАН                       АГОМЕЛАТИН   \n",
      "3              ЛИПРИМАР                     АТОРВАСТАТИН   \n",
      "4            КЕТОПРОФЕН                       КЕТОПРОФЕН   \n",
      "\n",
      "  МНН (нормализованное значение)  \\\n",
      "0                    ТРАСТУЗУМАБ   \n",
      "1            ЛОПИНАВИР+РИТОНАВИР   \n",
      "2                     АГОМЕЛАТИН   \n",
      "3                   АТОРВАСТАТИН   \n",
      "4                     КЕТОПРОФЕН   \n",
      "\n",
      "                     Наименование товара на этикетке  ...    №  \\\n",
      "0  ГЕРЦЕПТИН, ЛИОФИЛИЗАТ ДЛЯ ПРИГОТОВЛЕНИЯ КОНЦЕН...  ...  NaN   \n",
      "1  КАЛЕТРА®, ТАБЛЕТКИ ПОКРЫТЫЕ ПЛЕНОЧНОЙ ОБОЛОЧКО...  ...  2.0   \n",
      "2  ВАЛЬДОКСАН®, ТАБЛЕТКИ, ПОКРЫТЫЕ ПЛЕНОЧНОЙ ОБОЛ...  ...  4.0   \n",
      "3  ЛИПРИМАР, ТАБЛЕТКИ ПОКРЫТЫЕ ПЛЕНОЧНОЙ ОБОЛОЧКО...  ...  4.0   \n",
      "4        КЕТОПРОФЕН ГЕЛЬ ДЛЯ НАРУЖНОГО ПРИМЕНЕНИЯ 5%  ...  NaN   \n",
      "\n",
      "                                     Очищеный тайитл  \\\n",
      "0  ГЕРЦЕПТИН, ЛИОФИЛИЗАТ ДЛЯ ПРИГОТОВЛЕНИЯ КОНЦЕН...   \n",
      "1  КАЛЕТРА®, ТАБЛЕТКИ ПОКРЫТЫЕ ПЛЕНОЧНОЙ ОБОЛОЧКО...   \n",
      "2  ВАЛЬДОКСАН®, ТАБЛЕТКИ, ПОКРЫТЫЕ ПЛЕНОЧНОЙ ОБОЛ...   \n",
      "3  ЛИПРИМАР, ТАБЛЕТКИ ПОКРЫТЫЕ ПЛЕНОЧНОЙ ОБОЛОЧКО...   \n",
      "4  КЕТОПРОФЕН ГЕЛЬ ДЛЯ НАРУЖНОГО ПРИМЕНЕНИЯ 5% 30...   \n",
      "\n",
      "       Производитель готовой ЛФ Название проивзодителя для МС  \\\n",
      "0                ДЖЕНЕНТЕК ИНК.                     ДЖЕНЕНТЕК   \n",
      "1  ЭББВИ ДОЙЧЛАНД ГМБХ И КО. КГ                         ЭББВИ   \n",
      "2                ООО СЕРВЬЕ РУС                       СЕРВЬЕ*   \n",
      "3     ПФАЙЗЕР ФАРМАСЬЮТИКАЛ ЛЛС                  ЕСТЬ КАБИНЕТ   \n",
      "4                    ОАО СИНТЕЗ                       СИНТЕЗ*   \n",
      "\n",
      "                                     id  \\\n",
      "0  834BD517-4FDF-4D3F-A50E-97450A057805   \n",
      "1  C8197846-A43D-4FAB-A5E2-AB04CBA782E4   \n",
      "2  CAF4C351-0634-4F52-A092-1CC19BC3ED11   \n",
      "3                                   NaN   \n",
      "4  60A5C875-A54D-4CAD-AC07-2CE8227B58B8   \n",
      "\n",
      "  Страна регистрации производителя готовой ЛФ Код ТН ВЭД  \\\n",
      "0                           СОЕДИНЕННЫЕ ШТАТЫ          -   \n",
      "1                                    ГЕРМАНИЯ          -   \n",
      "2                                      РОССИЯ          -   \n",
      "3                                 ПУЭРТО-РИКО          -   \n",
      "4                                      РОССИЯ          -   \n",
      "\n",
      "  Контакт производителя Комплектность  Признак \"ПКУ\"  \n",
      "0                     -  РАСТВОРИТЕЛЬ            НЕТ  \n",
      "1                     -             ~            НЕТ  \n",
      "2                     -             ~            НЕТ  \n",
      "3                     -             ~            НЕТ  \n",
      "4                     -             ~            НЕТ  \n",
      "\n",
      "[5 rows x 35 columns]\n"
     ]
    }
   ],
   "source": [
    "# Display the column names\n",
    "# Convert all columns in the DataFrame to uppercase, if possible\n",
    "for col in df.columns:\n",
    "    if df[col].dtype == 'object':  # Only convert columns with string/object data type\n",
    "        df[col] = df[col].str.upper()\n",
    "\n",
    "# Display the first few rows to verify that all columns have been converted to uppercase\n",
    "print(df.head())\n",
    "\n"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-10-25T14:37:55.330243800Z",
     "start_time": "2024-10-25T14:37:55.117621200Z"
    }
   },
   "id": "1af06caf313b4e39"
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "outputs": [],
   "source": [
    "# List of required columns\n",
    "required_columns = [\n",
    "    'Unnamed: 0', 'GTIN', 'Торговое наименование', \n",
    "    'МНН (стандартизованное значение)', 'МНН (нормализованное значение)',\n",
    "    'Наименование товара на этикетке', \n",
    "    'Лекарственная форма (стандартизованное значение)', \n",
    "    'Лекарственная форма (нормализованное значение)',\n",
    "    'Дозировка (стандартизованное значение)', \n",
    "    'Дозировка (нормализованное значение)', 'Первичная упаковка',\n",
    "    'Масса/объем в первичной упаковке', \n",
    "    'Название единицы ОКЕИ для потребительской единицы лекарственного препарата',\n",
    "    'Количество массы/объёма вещества в первичной упаковке', \n",
    "    'Единица измерения вещества', \n",
    "    'Количество первичной упаковки в потребительской упаковке', \n",
    "    '№', 'Производитель готовой ЛФ', 'Название проивзодителя для МС', 'id'\n",
    "]\n",
    "\n",
    "# Filter the DataFrame to keep only the required columns\n",
    "df_filtered = df[required_columns]\n"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-10-25T14:38:00.491979500Z",
     "start_time": "2024-10-25T14:38:00.444926400Z"
    }
   },
   "id": "7a75b5adefe12cd0"
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "outputs": [
    {
     "data": {
      "text/plain": "       Unnamed: 0           GTIN Торговое наименование  \\\n0               0  4601907002829             ГЕРЦЕПТИН   \n1               4  4606556002770               КАЛЕТРА   \n2               9  4607159862518            ВАЛЬДОКСАН   \n3              11  4620017180104              ЛИПРИМАР   \n4              19  4602565019327            КЕТОПРОФЕН   \n...           ...            ...                   ...   \n29801       58062  4660153658686           ТРОКСЕРУТИН   \n29802       58063  4660153658693           ТРОКСЕРУТИН   \n29803       58064  4604060000121          ДЕЗЛОРАТАДИН   \n29804       58065  4605310029640            ЛОНГРАДАКС   \n29805       58066  4630179317591    БРИМОНТИМ СОЛОФАРМ   \n\n      МНН (стандартизованное значение) МНН (нормализованное значение)  \\\n0                          ТРАСТУЗУМАБ                    ТРАСТУЗУМАБ   \n1                  ЛОПИНАВИР+РИТОНАВИР            ЛОПИНАВИР+РИТОНАВИР   \n2                           АГОМЕЛАТИН                     АГОМЕЛАТИН   \n3                         АТОРВАСТАТИН                   АТОРВАСТАТИН   \n4                           КЕТОПРОФЕН                     КЕТОПРОФЕН   \n...                                ...                            ...   \n29801                      ТРОКСЕРУТИН                    ТРОКСЕРУТИН   \n29802                      ТРОКСЕРУТИН                    ТРОКСЕРУТИН   \n29803                     ДЕЗЛОРАТАДИН                   ДЕЗЛОРАТАДИН   \n29804                        ДЕСФЛУРАН                      ДЕСФЛУРАН   \n29805               БРИМОНИДИН+ТИМОЛОЛ             БРИМОНИДИН+ТИМОЛОЛ   \n\n                         Наименование товара на этикетке  \\\n0      ГЕРЦЕПТИН, ЛИОФИЛИЗАТ ДЛЯ ПРИГОТОВЛЕНИЯ КОНЦЕН...   \n1      КАЛЕТРА®, ТАБЛЕТКИ ПОКРЫТЫЕ ПЛЕНОЧНОЙ ОБОЛОЧКО...   \n2      ВАЛЬДОКСАН®, ТАБЛЕТКИ, ПОКРЫТЫЕ ПЛЕНОЧНОЙ ОБОЛ...   \n3      ЛИПРИМАР, ТАБЛЕТКИ ПОКРЫТЫЕ ПЛЕНОЧНОЙ ОБОЛОЧКО...   \n4            КЕТОПРОФЕН ГЕЛЬ ДЛЯ НАРУЖНОГО ПРИМЕНЕНИЯ 5%   \n...                                                  ...   \n29801  ТРОКСЕРУТИН, ГЕЛЬ ДЛЯ НАРУЖНОГО ПРИМЕНЕНИЯ 2% ...   \n29802  ТРОКСЕРУТИН, ГЕЛЬ ДЛЯ НАРУЖНОГО ПРИМЕНЕНИЯ 2% ...   \n29803  ДЕЗЛОРАТАДИН, ТАБЛЕТКИ, ПОКРЫТЫЕ ПЛЕНОЧНОЙ ОБО...   \n29804     ЛОНГРАДАКС® (ДЕСФЛУРАН) ЖИДКОСТЬ ДЛЯ ИНГАЛЯЦИЙ   \n29805  БРИМОНТИМ СОЛОФАРМ, 2 МГ/МЛ + 5 МГ/МЛ, КАПЛИ Г...   \n\n        Лекарственная форма (стандартизованное значение)  \\\n0      ЛИОФИЛИЗАТ ДЛЯ ПРИГОТОВЛЕНИЯ КОНЦЕНТРАТА ДЛЯ П...   \n1                           ТАБЛЕТКИ, ПОКРЫТЫЕ ОБОЛОЧКОЙ   \n2                           ТАБЛЕТКИ, ПОКРЫТЫЕ ОБОЛОЧКОЙ   \n3                           ТАБЛЕТКИ, ПОКРЫТЫЕ ОБОЛОЧКОЙ   \n4                          ГЕЛЬ ДЛЯ НАРУЖНОГО ПРИМЕНЕНИЯ   \n...                                                  ...   \n29801                      ГЕЛЬ ДЛЯ НАРУЖНОГО ПРИМЕНЕНИЯ   \n29802                      ГЕЛЬ ДЛЯ НАРУЖНОГО ПРИМЕНЕНИЯ   \n29803                       ТАБЛЕТКИ, ПОКРЫТЫЕ ОБОЛОЧКОЙ   \n29804                             ЖИДКОСТЬ ДЛЯ ИНГАЛЯЦИЙ   \n29805                                      КАПЛИ ГЛАЗНЫЕ   \n\n          Лекарственная форма (нормализованное значение)  \\\n0      ЛИОФИЛИЗАТ ДЛЯ ПРИГОТОВЛЕНИЯ КОНЦЕНТРАТА ДЛЯ П...   \n1                  ТАБЛЕТКИ ПОКРЫТЫЕ ПЛЕНОЧНОЙ ОБОЛОЧКОЙ   \n2                 ТАБЛЕТКИ, ПОКРЫТЫЕ ПЛЕНОЧНОЙ ОБОЛОЧКОЙ   \n3                  ТАБЛЕТКИ ПОКРЫТЫЕ ПЛЕНОЧНОЙ ОБОЛОЧКОЙ   \n4                          ГЕЛЬ ДЛЯ НАРУЖНОГО ПРИМЕНЕНИЯ   \n...                                                  ...   \n29801                      ГЕЛЬ ДЛЯ НАРУЖНОГО ПРИМЕНЕНИЯ   \n29802                      ГЕЛЬ ДЛЯ НАРУЖНОГО ПРИМЕНЕНИЯ   \n29803              ТАБЛЕТКИ ПОКРЫТЫЕ ПЛЕНОЧНОЙ ОБОЛОЧКОЙ   \n29804                             ЖИДКОСТЬ ДЛЯ ИНГАЛЯЦИЙ   \n29805                                      КАПЛИ ГЛАЗНЫЕ   \n\n      Дозировка (стандартизованное значение)  \\\n0                                     440 МГ   \n1                               200 МГ+50 МГ   \n2                                      25 МГ   \n3                                      20 МГ   \n4                                    50 МГ/Г   \n...                                      ...   \n29801                                20 МГ/Г   \n29802                                20 МГ/Г   \n29803                                   5 МГ   \n29804                                      ~   \n29805                           2 МГ+5 МГ/МЛ   \n\n      Дозировка (нормализованное значение)            Первичная упаковка  \\\n0                                   440 МГ                        ФЛАКОН   \n1                           200 МГ + 50 МГ                        ФЛАКОН   \n2                                    25 МГ                       БЛИСТЕР   \n3                                    20 МГ                       БЛИСТЕР   \n4                                      5 %               ТУБЫ ЛАМИНАТНЫЕ   \n...                                    ...                           ...   \n29801                                  2 %                          ТУБА   \n29802                                  2 %                          ТУБА   \n29803                                 5 МГ  УПАКОВКА ЯЧЕЙКОВАЯ КОНТУРНАЯ   \n29804                           НЕ УКАЗАНО                        ФЛАКОН   \n29805                    2 МГ/МЛ + 5 МГ/МЛ             ФЛАКОН-КАПЕЛЬНИЦА   \n\n       Масса/объем в первичной упаковке  \\\n0                                 440.0   \n1                                 120.0   \n2                                  14.0   \n3                                   7.0   \n4                                  30.0   \n...                                 ...   \n29801                             100.0   \n29802                              40.0   \n29803                              10.0   \n29804                             240.0   \n29805                               5.0   \n\n      Название единицы ОКЕИ для потребительской единицы лекарственного препарата  \\\n0                                                     МГ                           \n1                                                     ШТ                           \n2                                                     ШТ                           \n3                                                     ШТ                           \n4                                                      Г                           \n...                                                  ...                           \n29801                                                  Г                           \n29802                                                  Г                           \n29803                                                 ШТ                           \n29804                                         СМ[3*];^МЛ                           \n29805                                         СМ[3*];^МЛ                           \n\n      Количество массы/объёма вещества в первичной упаковке  \\\n0                                                440.000      \n1                                                      -      \n2                                                      -      \n3                                                      -      \n4                                                 30.000      \n...                                                  ...      \n29801                                            100.000      \n29802                                             40.000      \n29803                                                NaN      \n29804                                            240.000      \n29805                                              5.000      \n\n      Единица измерения вещества  \\\n0                             МГ   \n1                              -   \n2                              -   \n3                              -   \n4                              Г   \n...                          ...   \n29801                          Г   \n29802                          Г   \n29803                        NaN   \n29804                         МЛ   \n29805                         МЛ   \n\n       Количество первичной упаковки в потребительской упаковке    №  \\\n0                                                      1         NaN   \n1                                                      1         2.0   \n2                                                      1         4.0   \n3                                                      2         4.0   \n4                                                      1         NaN   \n...                                                  ...         ...   \n29801                                                  1         NaN   \n29802                                                  1         NaN   \n29803                                                  2         NaN   \n29804                                                  6         6.0   \n29805                                                  1         NaN   \n\n           Производитель готовой ЛФ Название проивзодителя для МС  \\\n0                    ДЖЕНЕНТЕК ИНК.                     ДЖЕНЕНТЕК   \n1      ЭББВИ ДОЙЧЛАНД ГМБХ И КО. КГ                         ЭББВИ   \n2                    ООО СЕРВЬЕ РУС                       СЕРВЬЕ*   \n3         ПФАЙЗЕР ФАРМАСЬЮТИКАЛ ЛЛС                  ЕСТЬ КАБИНЕТ   \n4                        ОАО СИНТЕЗ                       СИНТЕЗ*   \n...                             ...                           ...   \n29801                      OOO ОЗОН                      ОЗОН-МНН   \n29802                      OOO ОЗОН                      ОЗОН-МНН   \n29803        АО ТАТХИМФАРМПРЕПАРАТЫ         ТАТХИМФАРМПРЕПАРАТЫ $   \n29804                АО ФАРМАСИНТЕЗ                   ФАРМАСИНТЕЗ   \n29805                   ООО ГРОТЕКС                     ГРОТЕКС *   \n\n                                         id  \n0      834BD517-4FDF-4D3F-A50E-97450A057805  \n1      C8197846-A43D-4FAB-A5E2-AB04CBA782E4  \n2      CAF4C351-0634-4F52-A092-1CC19BC3ED11  \n3                                       NaN  \n4      60A5C875-A54D-4CAD-AC07-2CE8227B58B8  \n...                                     ...  \n29801  3B11B571-7218-43C4-90B9-BBCF3ABF2472  \n29802  3B11B571-7218-43C4-90B9-BBCF3ABF2472  \n29803  4210AF3E-AF48-4D85-BA65-4ED1D5927C4E  \n29804  867880F1-9566-4754-ACC2-15E13CADE035  \n29805  C8D54C89-3A3B-4C78-8C12-B995CB05DA10  \n\n[29806 rows x 20 columns]",
      "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Unnamed: 0</th>\n      <th>GTIN</th>\n      <th>Торговое наименование</th>\n      <th>МНН (стандартизованное значение)</th>\n      <th>МНН (нормализованное значение)</th>\n      <th>Наименование товара на этикетке</th>\n      <th>Лекарственная форма (стандартизованное значение)</th>\n      <th>Лекарственная форма (нормализованное значение)</th>\n      <th>Дозировка (стандартизованное значение)</th>\n      <th>Дозировка (нормализованное значение)</th>\n      <th>Первичная упаковка</th>\n      <th>Масса/объем в первичной упаковке</th>\n      <th>Название единицы ОКЕИ для потребительской единицы лекарственного препарата</th>\n      <th>Количество массы/объёма вещества в первичной упаковке</th>\n      <th>Единица измерения вещества</th>\n      <th>Количество первичной упаковки в потребительской упаковке</th>\n      <th>№</th>\n      <th>Производитель готовой ЛФ</th>\n      <th>Название проивзодителя для МС</th>\n      <th>id</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0</td>\n      <td>4601907002829</td>\n      <td>ГЕРЦЕПТИН</td>\n      <td>ТРАСТУЗУМАБ</td>\n      <td>ТРАСТУЗУМАБ</td>\n      <td>ГЕРЦЕПТИН, ЛИОФИЛИЗАТ ДЛЯ ПРИГОТОВЛЕНИЯ КОНЦЕН...</td>\n      <td>ЛИОФИЛИЗАТ ДЛЯ ПРИГОТОВЛЕНИЯ КОНЦЕНТРАТА ДЛЯ П...</td>\n      <td>ЛИОФИЛИЗАТ ДЛЯ ПРИГОТОВЛЕНИЯ КОНЦЕНТРАТА ДЛЯ П...</td>\n      <td>440 МГ</td>\n      <td>440 МГ</td>\n      <td>ФЛАКОН</td>\n      <td>440.0</td>\n      <td>МГ</td>\n      <td>440.000</td>\n      <td>МГ</td>\n      <td>1</td>\n      <td>NaN</td>\n      <td>ДЖЕНЕНТЕК ИНК.</td>\n      <td>ДЖЕНЕНТЕК</td>\n      <td>834BD517-4FDF-4D3F-A50E-97450A057805</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>4</td>\n      <td>4606556002770</td>\n      <td>КАЛЕТРА</td>\n      <td>ЛОПИНАВИР+РИТОНАВИР</td>\n      <td>ЛОПИНАВИР+РИТОНАВИР</td>\n      <td>КАЛЕТРА®, ТАБЛЕТКИ ПОКРЫТЫЕ ПЛЕНОЧНОЙ ОБОЛОЧКО...</td>\n      <td>ТАБЛЕТКИ, ПОКРЫТЫЕ ОБОЛОЧКОЙ</td>\n      <td>ТАБЛЕТКИ ПОКРЫТЫЕ ПЛЕНОЧНОЙ ОБОЛОЧКОЙ</td>\n      <td>200 МГ+50 МГ</td>\n      <td>200 МГ + 50 МГ</td>\n      <td>ФЛАКОН</td>\n      <td>120.0</td>\n      <td>ШТ</td>\n      <td>-</td>\n      <td>-</td>\n      <td>1</td>\n      <td>2.0</td>\n      <td>ЭББВИ ДОЙЧЛАНД ГМБХ И КО. КГ</td>\n      <td>ЭББВИ</td>\n      <td>C8197846-A43D-4FAB-A5E2-AB04CBA782E4</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>9</td>\n      <td>4607159862518</td>\n      <td>ВАЛЬДОКСАН</td>\n      <td>АГОМЕЛАТИН</td>\n      <td>АГОМЕЛАТИН</td>\n      <td>ВАЛЬДОКСАН®, ТАБЛЕТКИ, ПОКРЫТЫЕ ПЛЕНОЧНОЙ ОБОЛ...</td>\n      <td>ТАБЛЕТКИ, ПОКРЫТЫЕ ОБОЛОЧКОЙ</td>\n      <td>ТАБЛЕТКИ, ПОКРЫТЫЕ ПЛЕНОЧНОЙ ОБОЛОЧКОЙ</td>\n      <td>25 МГ</td>\n      <td>25 МГ</td>\n      <td>БЛИСТЕР</td>\n      <td>14.0</td>\n      <td>ШТ</td>\n      <td>-</td>\n      <td>-</td>\n      <td>1</td>\n      <td>4.0</td>\n      <td>ООО СЕРВЬЕ РУС</td>\n      <td>СЕРВЬЕ*</td>\n      <td>CAF4C351-0634-4F52-A092-1CC19BC3ED11</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>11</td>\n      <td>4620017180104</td>\n      <td>ЛИПРИМАР</td>\n      <td>АТОРВАСТАТИН</td>\n      <td>АТОРВАСТАТИН</td>\n      <td>ЛИПРИМАР, ТАБЛЕТКИ ПОКРЫТЫЕ ПЛЕНОЧНОЙ ОБОЛОЧКО...</td>\n      <td>ТАБЛЕТКИ, ПОКРЫТЫЕ ОБОЛОЧКОЙ</td>\n      <td>ТАБЛЕТКИ ПОКРЫТЫЕ ПЛЕНОЧНОЙ ОБОЛОЧКОЙ</td>\n      <td>20 МГ</td>\n      <td>20 МГ</td>\n      <td>БЛИСТЕР</td>\n      <td>7.0</td>\n      <td>ШТ</td>\n      <td>-</td>\n      <td>-</td>\n      <td>2</td>\n      <td>4.0</td>\n      <td>ПФАЙЗЕР ФАРМАСЬЮТИКАЛ ЛЛС</td>\n      <td>ЕСТЬ КАБИНЕТ</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>19</td>\n      <td>4602565019327</td>\n      <td>КЕТОПРОФЕН</td>\n      <td>КЕТОПРОФЕН</td>\n      <td>КЕТОПРОФЕН</td>\n      <td>КЕТОПРОФЕН ГЕЛЬ ДЛЯ НАРУЖНОГО ПРИМЕНЕНИЯ 5%</td>\n      <td>ГЕЛЬ ДЛЯ НАРУЖНОГО ПРИМЕНЕНИЯ</td>\n      <td>ГЕЛЬ ДЛЯ НАРУЖНОГО ПРИМЕНЕНИЯ</td>\n      <td>50 МГ/Г</td>\n      <td>5 %</td>\n      <td>ТУБЫ ЛАМИНАТНЫЕ</td>\n      <td>30.0</td>\n      <td>Г</td>\n      <td>30.000</td>\n      <td>Г</td>\n      <td>1</td>\n      <td>NaN</td>\n      <td>ОАО СИНТЕЗ</td>\n      <td>СИНТЕЗ*</td>\n      <td>60A5C875-A54D-4CAD-AC07-2CE8227B58B8</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>29801</th>\n      <td>58062</td>\n      <td>4660153658686</td>\n      <td>ТРОКСЕРУТИН</td>\n      <td>ТРОКСЕРУТИН</td>\n      <td>ТРОКСЕРУТИН</td>\n      <td>ТРОКСЕРУТИН, ГЕЛЬ ДЛЯ НАРУЖНОГО ПРИМЕНЕНИЯ 2% ...</td>\n      <td>ГЕЛЬ ДЛЯ НАРУЖНОГО ПРИМЕНЕНИЯ</td>\n      <td>ГЕЛЬ ДЛЯ НАРУЖНОГО ПРИМЕНЕНИЯ</td>\n      <td>20 МГ/Г</td>\n      <td>2 %</td>\n      <td>ТУБА</td>\n      <td>100.0</td>\n      <td>Г</td>\n      <td>100.000</td>\n      <td>Г</td>\n      <td>1</td>\n      <td>NaN</td>\n      <td>OOO ОЗОН</td>\n      <td>ОЗОН-МНН</td>\n      <td>3B11B571-7218-43C4-90B9-BBCF3ABF2472</td>\n    </tr>\n    <tr>\n      <th>29802</th>\n      <td>58063</td>\n      <td>4660153658693</td>\n      <td>ТРОКСЕРУТИН</td>\n      <td>ТРОКСЕРУТИН</td>\n      <td>ТРОКСЕРУТИН</td>\n      <td>ТРОКСЕРУТИН, ГЕЛЬ ДЛЯ НАРУЖНОГО ПРИМЕНЕНИЯ 2% ...</td>\n      <td>ГЕЛЬ ДЛЯ НАРУЖНОГО ПРИМЕНЕНИЯ</td>\n      <td>ГЕЛЬ ДЛЯ НАРУЖНОГО ПРИМЕНЕНИЯ</td>\n      <td>20 МГ/Г</td>\n      <td>2 %</td>\n      <td>ТУБА</td>\n      <td>40.0</td>\n      <td>Г</td>\n      <td>40.000</td>\n      <td>Г</td>\n      <td>1</td>\n      <td>NaN</td>\n      <td>OOO ОЗОН</td>\n      <td>ОЗОН-МНН</td>\n      <td>3B11B571-7218-43C4-90B9-BBCF3ABF2472</td>\n    </tr>\n    <tr>\n      <th>29803</th>\n      <td>58064</td>\n      <td>4604060000121</td>\n      <td>ДЕЗЛОРАТАДИН</td>\n      <td>ДЕЗЛОРАТАДИН</td>\n      <td>ДЕЗЛОРАТАДИН</td>\n      <td>ДЕЗЛОРАТАДИН, ТАБЛЕТКИ, ПОКРЫТЫЕ ПЛЕНОЧНОЙ ОБО...</td>\n      <td>ТАБЛЕТКИ, ПОКРЫТЫЕ ОБОЛОЧКОЙ</td>\n      <td>ТАБЛЕТКИ ПОКРЫТЫЕ ПЛЕНОЧНОЙ ОБОЛОЧКОЙ</td>\n      <td>5 МГ</td>\n      <td>5 МГ</td>\n      <td>УПАКОВКА ЯЧЕЙКОВАЯ КОНТУРНАЯ</td>\n      <td>10.0</td>\n      <td>ШТ</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>2</td>\n      <td>NaN</td>\n      <td>АО ТАТХИМФАРМПРЕПАРАТЫ</td>\n      <td>ТАТХИМФАРМПРЕПАРАТЫ $</td>\n      <td>4210AF3E-AF48-4D85-BA65-4ED1D5927C4E</td>\n    </tr>\n    <tr>\n      <th>29804</th>\n      <td>58065</td>\n      <td>4605310029640</td>\n      <td>ЛОНГРАДАКС</td>\n      <td>ДЕСФЛУРАН</td>\n      <td>ДЕСФЛУРАН</td>\n      <td>ЛОНГРАДАКС® (ДЕСФЛУРАН) ЖИДКОСТЬ ДЛЯ ИНГАЛЯЦИЙ</td>\n      <td>ЖИДКОСТЬ ДЛЯ ИНГАЛЯЦИЙ</td>\n      <td>ЖИДКОСТЬ ДЛЯ ИНГАЛЯЦИЙ</td>\n      <td>~</td>\n      <td>НЕ УКАЗАНО</td>\n      <td>ФЛАКОН</td>\n      <td>240.0</td>\n      <td>СМ[3*];^МЛ</td>\n      <td>240.000</td>\n      <td>МЛ</td>\n      <td>6</td>\n      <td>6.0</td>\n      <td>АО ФАРМАСИНТЕЗ</td>\n      <td>ФАРМАСИНТЕЗ</td>\n      <td>867880F1-9566-4754-ACC2-15E13CADE035</td>\n    </tr>\n    <tr>\n      <th>29805</th>\n      <td>58066</td>\n      <td>4630179317591</td>\n      <td>БРИМОНТИМ СОЛОФАРМ</td>\n      <td>БРИМОНИДИН+ТИМОЛОЛ</td>\n      <td>БРИМОНИДИН+ТИМОЛОЛ</td>\n      <td>БРИМОНТИМ СОЛОФАРМ, 2 МГ/МЛ + 5 МГ/МЛ, КАПЛИ Г...</td>\n      <td>КАПЛИ ГЛАЗНЫЕ</td>\n      <td>КАПЛИ ГЛАЗНЫЕ</td>\n      <td>2 МГ+5 МГ/МЛ</td>\n      <td>2 МГ/МЛ + 5 МГ/МЛ</td>\n      <td>ФЛАКОН-КАПЕЛЬНИЦА</td>\n      <td>5.0</td>\n      <td>СМ[3*];^МЛ</td>\n      <td>5.000</td>\n      <td>МЛ</td>\n      <td>1</td>\n      <td>NaN</td>\n      <td>ООО ГРОТЕКС</td>\n      <td>ГРОТЕКС *</td>\n      <td>C8D54C89-3A3B-4C78-8C12-B995CB05DA10</td>\n    </tr>\n  </tbody>\n</table>\n<p>29806 rows × 20 columns</p>\n</div>"
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_filtered"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-10-25T14:38:02.390067700Z",
     "start_time": "2024-10-25T14:38:02.357485100Z"
    }
   },
   "id": "e867b24ae6762058"
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Number of Unique Values: 319\n",
      "Number of Missing Values: 0\n",
      "Data Type: float64\n",
      "\n",
      "Top 10 Most Common Values:\n",
      "Масса/объем в первичной упаковке\n",
      "10.00     10290\n",
      "5.00       1639\n",
      "30.00      1506\n",
      "100.00     1382\n",
      "1.00       1278\n",
      "          ...  \n",
      "41.70        10\n",
      "11.50        10\n",
      "23.30        10\n",
      "6.24          9\n",
      "2.40          9\n",
      "Name: count, Length: 100, dtype: int64\n",
      "\n",
      "Top 10 Least Common Values:\n",
      "Масса/объем в первичной упаковке\n",
      "2.06          2\n",
      "168.00        2\n",
      "8.24          2\n",
      "0.02          2\n",
      "97.34         2\n",
      "             ..\n",
      "0.03          1\n",
      "1.38          1\n",
      "1.30          1\n",
      "210.00        1\n",
      "4500000.00    1\n",
      "Name: count, Length: 100, dtype: int64\n"
     ]
    }
   ],
   "source": [
    "# Basic information about 'Лекарственная форма (стандартизованное значение)'\n",
    "lek_form_col = df_filtered['Масса/объем в первичной упаковке']\n",
    "\n",
    "# Number of unique values\n",
    "print(f\"Number of Unique Values: {lek_form_col.nunique()}\")\n",
    "\n",
    "# Number of missing values\n",
    "print(f\"Number of Missing Values: {lek_form_col.isna().sum()}\")\n",
    "\n",
    "# Data type of the column\n",
    "print(f\"Data Type: {lek_form_col.dtype}\")\n",
    "\n",
    "# Display a summary of the value counts\n",
    "lek_form_value_counts = lek_form_col.value_counts()\n",
    "print(f\"\\nTop 10 Most Common Values:\\n{lek_form_value_counts.head(100)}\")\n",
    "\n",
    "# Display the least common forms (potentially rare ones)\n",
    "print(f\"\\nTop 10 Least Common Values:\\n{lek_form_value_counts.tail(100)}\")\n"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-10-25T15:04:48.639527300Z",
     "start_time": "2024-10-25T15:04:48.581477400Z"
    }
   },
   "id": "cfc434f5c2e192fb"
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Simplified Unique Release Forms:\n",
      "АЭРОЗОЛЬ\n",
      "ГАЗ\n",
      "ГЕЛЬ\n",
      "ГРАНУЛЫ\n",
      "ДРАЖЕ\n",
      "ЖИДКОСТЬ\n",
      "ИМПЛАНТАТ\n",
      "КАПЛИ\n",
      "КАПСУЛЫ\n",
      "КАРАНДАШ\n",
      "КЛЕЙ\n",
      "КОНЦЕНТРАТ\n",
      "КОРА\n",
      "КОРНЕВИЩА\n",
      "КОРНИ\n",
      "КРЕМ\n",
      "ЛАК\n",
      "ЛИНИМЕНТ\n",
      "ЛИОФИЛИЗАТ\n",
      "ЛИСТЬЯ\n",
      "ЛИСТЬЯ-ПОРОШОК\n",
      "МАЗЬ\n",
      "МАСЛО\n",
      "НАБОР\n",
      "НАСТОЙКА\n",
      "ОПОДЕЛЬДОК\n",
      "ПАСТА\n",
      "ПАСТИЛКИ\n",
      "ПЕНА\n",
      "ПЛАСТЫРЬ\n",
      "ПЛЕНКИ\n",
      "ПЛОДЫ\n",
      "ПОБЕГИ\n",
      "ПОРОШОК\n",
      "ПОЧКИ\n",
      "РАСТВОР\n",
      "РАСТВОРИТЕЛЬ\n",
      "СБОР\n",
      "СЕМЕНА\n",
      "СИРОП\n",
      "СИСТЕМА\n",
      "СЛОЕВИЩА\n",
      "СОК\n",
      "СПРЕЙ\n",
      "СТОЛБИКИ\n",
      "СУППОЗИТОРИЕВ\n",
      "СУППОЗИТОРИИ\n",
      "СУСПЕНЗИЯ\n",
      "ТАБЛЕТКИ\n",
      "ТАБЛЕТКИ-ЛИОФИЛИЗАТ\n",
      "ТРАВА\n",
      "ТРАВА-ПОРОШОК\n",
      "ЦВЕТКИ\n",
      "ЦВЕТКИ-ПОРОШОК\n",
      "ЧАГА\n",
      "ШАМПУНЬ\n",
      "ЭКСТРАКТ\n",
      "ЭЛИКСИР\n",
      "ЭМУЛЬСИЯ\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/tmp/ipykernel_451279/2844739006.py:2: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  df_filtered['Лекарственная форма (стандартизованное значение)'] = df_filtered['Лекарственная форма (стандартизованное значение)'].apply(\n"
     ]
    }
   ],
   "source": [
    "# Extract the first word and remove trailing commas\n",
    "df_filtered['Лекарственная форма (стандартизованное значение)'] = df_filtered['Лекарственная форма (стандартизованное значение)'].apply(\n",
    "    lambda x: x.split()[0].replace(',', '')\n",
    ")\n",
    "\n",
    "# Display the unique values to verify the result\n",
    "lek_form_unique_values = df_filtered['Лекарственная форма (стандартизованное значение)'].unique()\n",
    "print(\"\\nSimplified Unique Release Forms:\")\n",
    "for value in sorted(lek_form_unique_values):\n",
    "    print(value)\n"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-10-25T14:41:29.327500900Z",
     "start_time": "2024-10-25T14:41:29.313031200Z"
    }
   },
   "id": "a344e4f1f4c90261"
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "     ПОЛНОЕ НАИМЕНОВАНИЕ ПРЕПАРАТА\n",
      "0      ГЕРЦЕПТИН ЛИОФИЛИЗАТ 440 МГ\n",
      "1  КАЛЕТРА ТАБЛЕТКИ 200 МГ + 50 МГ\n",
      "2        ВАЛЬДОКСАН ТАБЛЕТКИ 25 МГ\n",
      "3          ЛИПРИМАР ТАБЛЕТКИ 20 МГ\n",
      "4              КЕТОПРОФЕН ГЕЛЬ 5 %\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/tmp/ipykernel_451279/1768119565.py:5: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  df_filtered[new_column_name] = df_filtered.apply(\n"
     ]
    }
   ],
   "source": [
    "# Define the name of the new column\n",
    "new_column_name = 'ПОЛНОЕ НАИМЕНОВАНИЕ ПРЕПАРАТА'\n",
    "\n",
    "# Create the new column with the concatenation logic, adding the additional condition for dosage\n",
    "df_filtered[new_column_name] = df_filtered.apply(\n",
    "    lambda row: (\n",
    "        f\"{row['Торговое наименование']} {row['Лекарственная форма (стандартизованное значение)']} {row['Дозировка (нормализованное значение)']}\"\n",
    "        if '~' not in str(row['Дозировка (нормализованное значение)']) and str(row['Дозировка (нормализованное значение)']).strip().upper() != 'НЕ УКАЗАНО'\n",
    "        else ''\n",
    "    ),\n",
    "    axis=1\n",
    ")\n",
    "\n",
    "# Display the first few rows to verify the result\n",
    "print(df_filtered[[new_column_name]].head())\n"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-10-25T14:41:35.808407700Z",
     "start_time": "2024-10-25T14:41:35.331915100Z"
    }
   },
   "id": "2f9354d11e2f66c8"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [],
   "metadata": {
    "collapsed": false
   },
   "id": "ec8200b0f1379ae"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [],
   "metadata": {
    "collapsed": false
   },
   "id": "5d3fe67e79a692a0"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [],
   "metadata": {
    "collapsed": false
   },
   "id": "aa2f01315c94d17e"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [],
   "metadata": {
    "collapsed": false
   },
   "id": "5cbf954883660fd2"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [],
   "metadata": {
    "collapsed": false
   },
   "id": "5c71c5340ff8f2c3"
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 2
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython2",
   "version": "2.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
